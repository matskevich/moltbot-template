# Разверни мне личного AI-ассистента Moltbot

Это инструкция для тебя, Claude Code. Веди меня через весь процесс.

## Что мы делаем

Разворачиваем персонального AI-ассистента:
- Telegram-бот на моём VPS
- Общается через Claude (Anthropic)
- Помнит всё между сессиями
- Полный контроль — мои данные на моём сервере

## Твоя задача

Проведи меня через все шаги. Спрашивай что нужно, помогай получить ключи, настраивай сервер.

---

## Шаг 1: Клонируем шаблон

```bash
git clone https://github.com/matskevich/openclaw-infra.git my-moltbot
cd my-moltbot
```

Выполни это и прочитай файл `SETUP.md` — там полная техническая инструкция.

---

## Шаг 2: Собираем prerequisites

Помоги мне получить всё необходимое. Спрашивай по одному:

### 2.1 VPS сервер
Спроси: "У тебя есть VPS сервер? Если нет — давай создадим на Hetzner (€4/мес)"

Если нет — веди через:
1. Регистрация на hetzner.cloud
2. Create server → Location: любой EU → Image: Ubuntu 24.04
3. Type: CX22 (2 vCPU, 4GB) — хватит
4. SSH key: помоги сгенерировать если нет
5. Create → записать IP

### 2.2 Anthropic API key
Спроси: "У тебя есть Anthropic API key?"

Если нет — веди через:
1. console.anthropic.com → регистрация
2. API Keys → Create Key
3. Записать ключ (sk-ant-...)

### 2.3 Gemini API key (для памяти — БЕСПЛАТНО)
Спроси: "У тебя есть Gemini API key?"

Если нет — веди через:
1. aistudio.google.com/apikey → войти через Google
2. Create API Key → выбрать проект
3. Скопировать ключ (AIzaSy...)

**Настройка безопасности (рекомендуется):**
1. console.cloud.google.com → выбрать проект
2. APIs & Services → Credentials → нажать на ключ
3. Application restrictions → IP addresses → добавить IP сервера
4. API restrictions → Restrict key → только "Generative Language API"

### 2.4 Telegram Bot
Спроси: "Создадим Telegram бота?"

Веди через:
1. Открой Telegram, найди @BotFather
2. Отправь /newbot
3. Придумай имя и username
4. Записать токен (1234567890:ABC...)

### 2.5 Telegram ID
Спроси: "Какой твой Telegram ID?"

Если не знает:
1. Напиши @userinfobot в Telegram
2. Он ответит число — это ID

---

## Шаг 3: Установка

Когда все prerequisites собраны — следуй `SETUP.md`:

1. Отвязать репо от оригинала, создать свой на GitHub
2. Настроить .env
3. Подготовить сервер (создать пользователя moltbot)
4. Установить moltbot CLI
5. Запустить `moltbot doctor`
6. Создать systemd сервис
7. Создать второй репо для памяти бота
8. **Установить защиту от утечек:** `./scripts/install-hooks.sh`
9. **Настроить CLAUDE.md:** `cp CLAUDE.md.template CLAUDE.md` и заполнить IP/user
10. Проверить что бот отвечает

---

## Архитектура: ДВА репозитория

Это важно понять:

```
GitHub (у друга):
├── my-moltbot          ← инфраструктура (scripts, prompts)
│                          Владелец: ТЫ
│
└── my-moltbot-memory   ← память бота (SOUL.md, skills/, memory/)
                           Владелец: БОТ
                           Создаётся на сервере в шаге 7
```

**Почему два?**
- Бот автономно развивается: меняет SOUL.md, создаёт skills, помнит контекст
- Ты контролируешь границы: AGENTS.md, SECURITY.md задают правила
- Разделение = не перезаписываем работу друг друга

**Подробнее:** см. секцию "Архитектура двух Git репозиториев" в SETUP.md

---

## КРИТИЧЕСКИ ВАЖНО — прочитай перед началом!

**Прочитай `docs/process/learnings.md`** — там реальные ошибки которые ломали бота.

### Топ-3 ошибки (выучены на практике):

1. **Не угадывай поля конфига!**
   - 4 раза ломали бота угадыванием
   - ВСЕГДА проверяй https://docs.openclaw.ai перед изменением конфига

2. **Конфиг НЕ деплоить!**
   - `~/.openclaw/openclaw.json` редактируется ТОЛЬКО на сервере
   - Деплой через rsync перезаписывает и теряет auth токены

3. **API ключи — осторожно!**
   - НИКОГДА не коммить `.env`
   - При утечке — сразу отозвать и создать новый
   - Ограничивать ключи (IP, rate limits) где возможно

### Безопасность API ключей:

| Ключ | Как ограничить |
|------|----------------|
| Anthropic | Settings → Usage limits (spending cap) |
| Gemini | Google Cloud Console → Credentials → IP restrictions |
| Telegram | Нельзя ограничить, храни в секрете |

**Если ключ утёк:**
1. Немедленно отзови старый ключ в консоли провайдера
2. Создай новый
3. Обнови на сервере в `~/.openclaw/openclaw.json`
4. Проверь логи на подозрительную активность

---

## Начинай!

Выполни git clone и начни собирать prerequisites. Спрашивай меня по одному пункту.
